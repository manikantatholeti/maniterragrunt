pipeline {
    agent any
    stages {
        stage('Checkout') {
            steps {
                dir('/var/lib/jenkins/workspace/terragrunt-testv2') {
                checkout scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[credentialsId: '0c9a9019-7993-430a-a6fe-bbe2de5ea06f', url: 'git@github.com:manikantatholeti/maniterragrunt.git']])
                // sh 'sudo chmod -R 777 /var/lib/jenkins/workspace/terragrunt-testv2'
                sh 'aws sts get-caller-identity'
                }
            }
        }
        stage('Terragrunt Deployment') {
            steps {
                 script {
                  dir('/var/lib/jenkins/workspace/terragrunt-testv2/env/dev/tde') {
                        sh 'terragrunt init'
                        sh 'terragrunt plan'
                        sh 'terragrunt apply -auto-approve'
                    }
                }
              }
         }
    }
}